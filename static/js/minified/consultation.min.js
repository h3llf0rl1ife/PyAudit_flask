var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$(function(){var a=$("meta[name=csrf]").attr("content");$.ajaxSetup({beforeSend:function(b,c){/^(GET|HEAD|OPTIONS|TRACE)$/i.test(c.type)||this.crossDomain||b.setRequestHeader("X-CSRFToken",a)}});initMaterialize();searchClickHandler();clearClickHandler();deleteClickHandler();editChangeHandler();selectChangeHandler();applyClickHandler();$("#SiteID").trigger("change");$("#Search").trigger("click")});
function getData(a,b,c){$.getJSON("/consultation/api",{value:a,field:b},function(a){if("TableData"===b){$("#dataTable tbody tr").remove();window.attachments={};window.tableData=a.result;if(0==a.result.length)for($("#dataTable tbody").append($("<tr></tr>")),a=1;15>=a;a++)$("#dataTable tbody tr").append($("<td></td>").html("&nbsp;"));else makePagination(),nextPage(0),paginationClickHandler();$("#Search").removeClass("disabled")}else{removeOptions(b,c);for(var d=0,e=a.result.length;d<e;d++){var g=a.result[d][b+
"Name"];if("Category"===b||"LocationType"===b)g=a.result[d].Description;var h=$("#"+b+"ID");c&&(h=$("#i-"+b));h.append($("<option></option>").attr("value",a.result[d][b+"ID"]).text(g))}$("select").material_select()}})}function removeOptions(a,b){var c=a;b?c=$("#i-"+a):a instanceof jQuery||(c=$("#"+a+"ID"));c[0].selectedIndex=0;c.children("option:not(:first)").remove()}
function loadAttachments(a){var b=$("#image-attachments"),c=$("#other-attachments");b.text("");c.addClass("hide");$("img",b).remove();$("li",c).remove();$("h6",c).remove();var e=window.attachments[a][0];a=window.attachments[a][1];var d=e.length,f=a.length;if(0!==d){for(var g=0;g<d;g++)b.append($("<img>").attr({"class":"responsive-img materialboxed col s12",src:e[g][1]}));$(".materialboxed").materialbox()}else 0!==f?b.text("Aucune photo."):b.text("Aucune pi\u00e8ce jointe.");if(0!==f)for(c.removeClass("hide"),
c.prepend($("<h6></h6>").text("Autres pi\u00e8ces jointes :")),b=0;b<f;b++)c=a[b][1].split("/"),$("#other-attachments-ul").append($("<li></li>").append($("<a></a>").attr({href:a[b][1]}).text(c[c.length-1])))}
function selectChangeHandler(){var a=["Zone","Unit","LocationType","Location"],b=a.slice(1,a.length),c=a.slice(2,a.length),e=a.slice(3,a.length);a=[[$("#i-Site"),a,!0],[$("#i-Zone"),b,!0],[$("#i-Unit"),c,!0],[$("#i-LocationType"),e,!0],[$("#i-Criteria"),["Category"],!0],[$("#SiteID"),a,!1],[$("#ZoneID"),b,!1],[$("#UnitID"),c,!1],[$("#LocationTypeID"),e,!1],[$("#CriteriaID"),["Category"],!1]];$.each(a,function(a,b){var c=b[0],e=b[1],d=b[2],f=e.slice(0,e.length);c.on("change",function(){for(var a=0,
b=f.length;a<b;a++)removeOptions(f[a],d);a=$(this).val();"Location"==f[0]&&(a=$("#UnitID"),d&&(a=$("#i-Unit")),a={LocationTypeID:$(this).val(),UnitID:a.val()},a=JSON.stringify(a));getData(a,f[0],d)})})}
function editChangeHandler(){var a=[[$("#checkbox-location"),[$("#i-Site"),$("#i-Zone"),$("#i-Unit"),$("#i-LocationType"),$("#i-Location")]],[$("#checkbox-criteria"),[$("#i-Criteria"),$("#i-Category"),$("#i-Validation")]],[$("#checkbox-comment"),[$("#i-Comment")]],[$("#checkbox-feedback"),[$("#i-Feedback")]],[$("#checkbox-attachment"),[$("#i-File"),$("#i-File-Path")]]];$.each(a,function(a,c){var b=c[0],d=c[1];b.on("change",function(){var a={disabled:!0,required:!1};$(this).prop("checked")&&(a={disabled:!1,
required:!0});var c=["i-Site","i-Criteria","i-Validation"];$.each(d,function(b,d){d.prop(a);a.disabled&&(d.is("input, textarea")||-1<$.inArray(d.attr("id"),c)?(d.val(""),$("textarea").trigger("autoresize")):d.is("select")&&removeOptions(d,!1))});"checkbox-attachment"===b.attr("id")&&$("#attachment-ul .filled-in").prop("disabled",a.disabled)})})}function setEditID(a){window.editID=a}function setDeleteID(a){window.deleteID=a}
function updateData(a,b,c){$.ajax({url:"/consultation/api",type:"POST",data:{value:a,field:b,edit_id:c},success:function(a){getData(window.tableDataQuery,"TableData")},error:function(a){console.log(a)}})}
function uploadData(a,b,c,e){var d=new FormData;$.each(a,function(a,b){d.append("value",b)});d.append("field",b);d.append("edit_id",c);d.append("deleted",e);$.ajax({url:"/consultation/api",type:"POST",data:d,processData:!1,contentType:!1,success:function(a){getData(window.tableDataQuery,"TableData")},error:function(a){console.log(a)}})}
function deleteData(){$.ajax({url:"/consultation/api",type:"POST",data:{field:"DeleteData",value:window.deleteID},success:function(a){getData(window.tableDataQuery,"TableData")},error:function(a){console.log(a)}})}
function makePagination(){var a=$("#pagination-ul"),b=$("li:first",a),c=$("li:last-child",a);b.addClass("disabled");$("li:not(:first)",a).remove();for(b=1;b<=Math.ceil(window.tableData.length/50);b++){var e='<li class="waves-effect"><a class="page-btn" value="'+b+'">'+b+"</a></li>";1==b&&(e='<li class="waves-effect active blue-grey darken-1"><a class="page-btn" value="'+b+'">'+b+"</a></li>");a.append(e)}a.append(c);3>=$("li",a).length?c.addClass("disabled"):c.removeClass("disabled")}
function nextPage(a){var b=0,c=50;0<a&&(c=50*a,b=c-50);$("#dataTable tbody tr").remove();a=window.tableData.slice(b,c);b="EvaluationID Date User Site Zone Unit LocationType Location Criteria Category Validation Comment Feedback".split(" ");c=0;for(var e=a.length;c<e;c++){for(var d=$("<tr></tr>"),f=0,g=b.length;f<g;f++)d.append($("<td></td>").text(a[c][b[f]]));d.append($("<td></td>").append($("<a></a>").attr({"class":"modal-trigger",href:"#modal-image",onclick:"loadAttachments("+a[c].EvaluationID+
")"}).text("Voir")),$("<td></td>").append($("<a></a>").attr({"class":"modal-trigger",href:"#modal-edit",onclick:"setEditID("+a[c].EvaluationID+")"}).append('<i class="material-icons">&#xE254;</i>'),$("<a></a>").attr({"class":"modal-trigger",href:"#modal-delete",onclick:"setDeleteID("+a[c].EvaluationID+")"}).append('<i class="material-icons">&#xE92B;</i>')));$("#dataTable tbody").append(d);window.attachments[a[c].EvaluationID]=a[c].Attachment}}
function paginationClickHandler(){function a(){var a=parseInt($("#pagination-ul li.active a.page-btn").attr("value"),10),c=parseInt($("#pagination-ul li:nth-last-child(2) a").attr("value"),10);return[a,c]}$("#chevron-left").on("click",function(){var b=$jscomp.makeIterator(a()),c=b.next().value;b.next();1!==c&&$("#pagination-ul li a[value="+(c-1)+"]").trigger("click")});$("#chevron-right").on("click",function(){var b=$jscomp.makeIterator(a()),c=b.next().value;b=b.next().value;c!==b&&$("#pagination-ul li a[value="+
(c+1)+"]").trigger("click")});$(".page-btn").on("click",function(){var b=a()[1],c=parseInt($(this).attr("value"),10);1<c?$("#chevron-left").removeClass("disabled"):$("#chevron-left").addClass("disabled");c<b?$("#chevron-right").removeClass("disabled"):$("#chevron-right").addClass("disabled");$(".page-btn").parent().removeClass("active blue-grey darken-1");$(this).parent().addClass("active blue-grey darken-1");nextPage(c)})}
function applyClickHandler(){$("#Apply").on("click",function(){var a={LocationID:[$("#checkbox-location").prop("checked")?1:0,null==$("#i-Location").val()?"":$("#i-Location").val()],CategoryID:[$("#checkbox-criteria").prop("checked")?1:0,null==$("#i-Category").val()?"":$("#i-Category").val()],Validation:[$("#checkbox-criteria").prop("checked")?1:0,null==$("#i-Validation").val()?"":$("#i-Validation").val()],Comment:[$("#checkbox-comment").prop("checked")?1:0,null==$("#i-Comment").val()?"":$("#i-Comment").val()],
Feedback:[$("#checkbox-feedback").prop("checked")?1:0,null==$("#i-Feedback").val()?"":$("#i-Feedback").val()]};updateData(JSON.stringify(a),"UpdateData",window.editID);if($("#checkbox-attachment").prop("checked")){a=$("#i-File")[0].files;var b=[];$.each($("#attachment-ul input[type=checkbox]"),function(a,e){if(!$(e).prop("checked")){var c=$(e).attr("id").split("-")[1];b.push(c)}});uploadData(a,"UpdateAttachment",window.editID,b)}})}
function deleteClickHandler(){$("#Delete").on("click",function(){deleteData()})}
function searchClickHandler(){$("#Search").on("click",function(){var a={dateFrom:$("#dateFrom").val(),dateTo:$("#dateTo").val(),SiteID:$("#SiteID").val(),ZoneID:$("#ZoneID").val(),UnitID:$("#UnitID").val(),LocationTypeID:$("#LocationTypeID").val(),LocationID:$("#LocationID").val(),CriteriaID:$("#CriteriaID").val(),CategoryID:$("#CategoryID").val(),Validation:$("#Validation").val()};$(this).addClass("disabled");window.tableDataQuery=JSON.stringify(a);getData(window.tableDataQuery,"TableData")})}
function clearClickHandler(){$("#Clear").on("click",function(){var a=[$("#dateFrom"),$("#dateTo"),$("#SiteID"),$("#CriteriaID"),$("#Validation")];$.each(a,function(a,c){c.val("")});$.each(["Zone","Unit","LocationType","Location","Category"],function(a,c){removeOptions(c,!1)});$("select").material_select()})}
function initMaterialize(){$(".datepicker").pickadate({selectMonths:!0,selectYears:5,closeOnSelect:!1,container:void 0,today:"Aujourd'hui",clear:"Effacer",close:"Ok",labelMonthNext:"Mois suivant",labelMonthPrev:"Mois pr\u00e9cedant",labelMonthSelect:"Selectionner un mois",labelYearSelect:"Selectionner une ann\u00e9e",monthsFull:"Janvier F\u00e9vrier Mars Avril Mai Juin Juillet Ao\u00fbt Septembre Octobre Novembre D\u00e9cembre".split(" "),monthsShort:"Janv. F\u00e9vr. Mars Avr. Mai Juin Juil. Ao\u00fbt Sept. Oct. Nov. D\u00e9c.".split(" "),
weekdaysFull:"Dimanche Lundi Mardi Mercredi Jeudi Vendredi Samedi".split(" "),weekdaysShort:"Dim Lun Mar Mer Jeu Ven Sam".split(" "),weekdaysLetter:"DLMMJVS".split("")});$("select").material_select();$(".materialboxed").materialbox();$(".modal").modal();$(".collapsible").collapsible();$("#modal-edit").modal({ready:function(){$("#attachment-ul li").remove();$.each(window.attachments[window.editID],function(a,b){$.each(b,function(a,b){var c=b[1].split("/");$("#attachment-ul").append($("<li></li>").append($("<input>").prop({type:"checkbox",
"class":"filled-in",id:"attach-"+b[0],checked:"checked",disabled:!0}),$("<label></label>").prop("for","attach-"+b[0]).text(c[c.length-1])))})})},complete:function(){var a=[$("#checkbox-location"),$("#checkbox-criteria"),$("#checkbox-comment"),$("#checkbox-feedback"),$("#checkbox-attachment")];$.each(a,function(a,c){c.prop("checked",!1);c.trigger("change")})}})};